please see main.ipynb for whole precess